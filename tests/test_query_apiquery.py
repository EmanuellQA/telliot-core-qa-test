import pytest

from telliot_core.queries.api_query import APIQuery


def test_constructor():
    """Validate spot price query"""
    q = APIQuery(api_url="https://samples.openweathermap.org/data/2.5/weather?q=Lond`on,uk&appid=b6907d289e10d714a6e88b30761fae22",
                 arg_string="temp_min, description")

    _ = b'{"type":"APIQuery","api_url":"https://samples.openweathermap.org/data/2.5/weather?q=Lond`on,uk&appid=b6907d289e10d714a6e88b30761fae22",' \
        b'"arg_string":"temp_min, description"}'  # exp_data_json
    exp_data = (
        0x00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000841504951756572790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000006768747470733a2f2f73616d706c65732e6f70656e776561746865726d61702e6f72672f646174612f322e352f776561746865723f713d4c6f6e64606f6e2c756b2661707069643d623639303764323839653130643731346136653838623330373631666165323200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001574656d705f6d696e2c206465736372697074696f6e0000000000000000000000
    )

    print(q.query_data.hex())
    #print(exp_data)
    #assert q.query_data.hex() == exp_data

    exp = "93aaa6e84b5a71474db3379116082d814628cefc52af39473db82824e97a5286"
    #assert q.query_id.hex() == exp
